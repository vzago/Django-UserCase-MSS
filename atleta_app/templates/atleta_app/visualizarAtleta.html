{% extends "atleta_app/base.html" %}

{% block title %}Visualizar Atletas - FutSteps{% endblock %}

{% block extra_head %}
<style>
    body {
        background: linear-gradient(135deg, #181818 0%, #232323 50%, #181818 100%) !important;
        min-height: 100vh;
    }
    .visualizar-atleta-card {
        max-width: 950px;
        margin: 100px auto 100px auto;
        background: #232323;
        border-radius: 18px;
        box-shadow: 0 5px 24px rgba(0,0,0,0.35);
        padding: 0 0 36px 0;
        color: #f5f5f5;
    }
    .visualizar-atleta-header {
        background: linear-gradient(135deg, #181818 0%, #111 100%);
        border-radius: 18px 18px 0 0;
        padding: 38px 38px 18px 38px;
        color: #FFD700;
        text-align: center;
        box-shadow: 0 2px 10px rgba(0,0,0,0.18);
    }
    .visualizar-atleta-header h1 {
        font-size: 2.4rem;
        font-weight: 900;
        margin-bottom: 8px;
        letter-spacing: 1px;
        color: #FFD700;
        text-shadow: 1px 1px 8px #000;
    }
    .visualizar-atleta-header p {
        color: #ffe066;
        opacity: 0.92;
        font-size: 1.13rem;
    }
    .visualizar-atleta-form {
        padding: 28px 38px 0 38px;
        display: flex;
        flex-wrap: wrap;
        gap: 22px 28px;
        justify-content: space-between;
        align-items: flex-end;
        background: transparent;
    }
    .visualizar-atleta-form .form-group {
        flex: 1 1 180px;
        min-width: 180px;
    }
    .visualizar-atleta-form label {
        font-weight: 600;
        color: #FFD700;
        margin-bottom: 4px;
        display: block;
        letter-spacing: 0.5px;
    }
    .visualizar-atleta-form input {
        width: 100%;
        padding: 12px 14px;
        border-radius: 8px;
        border: 1.5px solid #444;
        font-size: 1rem;
        background: #181818;
        color: #FFD700;
        margin-bottom: 0;
        transition: border 0.2s, background 0.2s;
    }
    .visualizar-atleta-form input:focus {
        border-color: #FFD700;
        outline: none;
        background: #232323;
        color: #fffbe6;
    }
    .visualizar-atleta-form .form-actions {
        flex: 1 1 100%;
        display: flex;
        gap: 18px;
        margin-top: 16px;
    }
    .visualizar-atleta-form .btn-primary {
        background: #FFD700;
        color: #181818;
        border: none;
        font-weight: 700;
        box-shadow: 0 2px 8px rgba(255,215,0,0.10);
        transition: background 0.2s, color 0.2s;
    }
    .visualizar-atleta-form .btn-primary:hover {
        background: #ffe066;
        color: #000;
    }
    .visualizar-atleta-form .btn-secondary {
        background: #181818;
        color: #FFD700;
        border: 2px solid #FFD700;
        font-weight: 600;
        transition: background 0.2s, color 0.2s;
    }
    .visualizar-atleta-form .btn-secondary:hover {
        background: #FFD700;
        color: #181818;
    }
    .visualizar-atleta-table-wrapper {
        padding: 0 38px;
    }
    .atleta-encontrados-card {
        background: #181818;
        border-radius: 14px 14px 0 0;
        border: 2px solid #FFD700;
        margin-bottom: 0;
        margin-top: 24px;
        padding: 24px 24px 10px 24px;
        color: #FFD700;
        box-shadow: 0 2px 10px rgba(0,0,0,0.10);
    }
    .atleta-encontrados-card h2 {
        color: #FFD700;
        font-size: 1.3rem;
        font-weight: 700;
        margin-bottom: 10px;
    }
    .atleta-encontrados-card p {
        color: #ffe066;
        margin-bottom: 0;
    }
    .responsive-table {
        width: 100%;
        overflow-x: auto;
        background: #181818;
        border-radius: 0 0 12px 12px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.18);
        margin: 0 0 0 0;
        border: 2px solid #FFD700;
        border-top: none;
    }
    .atleta-table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0;
        background: transparent;
    }
    .table-header {
        background: linear-gradient(135deg, #181818 0%, #232323 100%);
        color: #FFD700;
        font-weight: 700;
        font-size: 1.08rem;
        border-radius: 12px 12px 0 0;
        border: none;
    }
    .table-header th {
        border-right: 2px solid #FFD700;
        border-bottom: 2px solid #FFD700;
        padding: 16px 12px;
        background: transparent;
    }
    .table-header th:last-child {
        border-right: none;
    }
    .table-row {
        border-bottom: 1px solid #333;
        background: #232323;
        color: #fff;
        transition: background 0.2s;
    }
    .table-row:nth-child(even) {
        background: #181818;
    }
    .table-row:hover {
        background: #333300;
        color: #FFD700;
    }
    .table-cel {
        padding: 16px 12px;
        text-align: left;
        font-size: 1.04rem;
    }
    .atleta-header h2, .atleta-header p {
        color: #FFD700 !important;
    }
    .atleta-header {
        margin-top: 24px;
        text-align: left;
    }
    .messages-container .message.error {
        background: #2d1a1a;
        color: #FFD700;
        border: 1.5px solid #FFD700;
    }
    /* Card detalhado do atleta */
    .atleta-detalhe-card {
        background: #181818;
        border-radius: 14px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.18);
        border: 2px solid #FFD700;
        margin: 32px 0 32px 0;
        padding: 32px 28px 24px 28px;
        color: #FFD700;
        max-width: 700px;
        margin-left: auto;
        margin-right: auto;
    }
    .atleta-detalhe-header {
        display: flex;
        align-items: center;
        gap: 18px;
        margin-bottom: 18px;
    }
    .atleta-detalhe-avatar {
        width: 60px;
        height: 60px;
        background: #FFD700;
        color: #181818;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 2.2rem;
        font-weight: 900;
        box-shadow: 0 2px 8px rgba(255,215,0,0.15);
    }
    .atleta-detalhe-nome {
        font-size: 1.6rem;
        font-weight: 800;
        color: #FFD700;
    }
    .atleta-detalhe-info {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 18px 12px;
        margin-bottom: 10px;
    }
    .atleta-detalhe-label {
        color: #ffe066;
        font-weight: 600;
        font-size: 1.05rem;
    }
    .atleta-detalhe-value {
        color: #fff;
        font-size: 1.08rem;
        font-weight: 500;
    }
    @media (max-width: 900px) {
        .visualizar-atleta-card { padding: 0 0 20px 0; }
        .visualizar-atleta-header, .visualizar-atleta-form, .visualizar-atleta-table-wrapper { padding-left: 10px; padding-right: 10px; }
        .atleta-detalhe-card { padding: 24px 8px 18px 8px; }
        .atleta-encontrados-card { padding: 16px 4px 6px 4px; }
    }
    @media (max-width: 700px) {
        .atleta-detalhe-info { grid-template-columns: 1fr 1fr; }
    }
    @media (max-width: 500px) {
        .atleta-detalhe-info { grid-template-columns: 1fr; }
    }
</style>
<script>
window.addEventListener('DOMContentLoaded', function() {
    var cpfInput = document.getElementById('cpf');
    if (cpfInput) {
        cpfInput.classList.add('cpf-input');
        if (window.applyCpfMask) window.applyCpfMask(cpfInput);
        // Bloqueio dos outros filtros
        var nome = document.getElementById('nome');
        var clube = document.getElementById('clube');
        var posicao = document.getElementById('posicao');
        function toggleFilters() {
            if (cpfInput.value.replace(/\D/g, '').length > 0) {
                if (nome) { nome.value = ''; nome.disabled = true; }
                if (clube) { clube.value = ''; clube.disabled = true; }
                if (posicao) { posicao.value = ''; posicao.disabled = true; }
            } else {
                if (nome) nome.disabled = false;
                if (clube) clube.disabled = false;
                if (posicao) posicao.disabled = false;
            }
        }
        cpfInput.addEventListener('input', toggleFilters);
        toggleFilters();
    }
});
</script>
{% endblock %}

{% block content %}
<div class="visualizar-atleta-card">
    <div class="visualizar-atleta-header">
        <h1>üëÄ Visualizar Atletas</h1>
        <p>Consulte rapidamente os atletas cadastrados. Use os filtros para refinar sua busca.</p>
    </div>
    <form method="get" action="{% url 'visualizarAtleta' %}" class="visualizar-atleta-form">
        <div class="form-group">
            <label for="cpf">üÜî CPF</label>
            <input type="text" id="cpf" name="cpf" class="cpf-input" placeholder="000.000.000-00" maxlength="14" value="{{ cpf|default:'' }}" autocomplete="off" />
        </div>
        <div class="form-group">
            <label for="nome">üë§ Nome</label>
            <input type="text" id="nome" name="nome" placeholder="Nome do atleta" value="{{ nome|default:'' }}" />
        </div>
        <div class="form-group">
            <label for="clube">üèÜ Clube</label>
            <input type="text" id="clube" name="clube" placeholder="Clube do atleta" value="{{ clube|default:'' }}" />
        </div>
        <div class="form-group">
            <label for="posicao">‚öΩ Posi√ß√£o</label>
            <input type="text" id="posicao" name="posicao" placeholder="Posi√ß√£o do atleta" value="{{ posicao|default:'' }}" />
        </div>
        <div class="form-actions">
            <button type="submit" class="btn btn-primary"><span class="btn-icon">üîç</span> Filtrar</button>
            <a href="{% url 'visualizarAtleta' %}" class="btn btn-secondary">Limpar Filtros</a>
            <a href="{% url 'home' %}" class="btn btn-secondary"><span class="btn-icon">üè†</span> Voltar ao In√≠cio</a>
        </div>
    </form>
    {% if error_message %}
    <div class="messages-container" style="padding: 0 38px;">
        <div class="message error">
            <span class="error-icon">‚ö†Ô∏è</span>
            {{ error_message }}
            <button class="message-close" onclick="this.parentElement.remove()">&times;</button>
        </div>
    </div>
    {% endif %}
    <div class="visualizar-atleta-table-wrapper">
        {# Card detalhado se busca por CPF e s√≥ um atleta #}
        {% if cpf and atletas|length == 1 %}
        {% with atleta=atletas.0 %}
        <div class="atleta-detalhe-card">
            <div class="atleta-detalhe-header">
                <div class="atleta-detalhe-avatar">‚öΩ</div>
                <div class="atleta-detalhe-nome">{{ atleta.nome }}</div>
            </div>
            <div class="atleta-detalhe-info">
                <div>
                    <div class="atleta-detalhe-label">üÜî CPF</div>
                    <div class="atleta-detalhe-value">{{ atleta.cpf }}</div>
                </div>
                <div>
                    <div class="atleta-detalhe-label">üéÇ Idade</div>
                    <div class="atleta-detalhe-value">{{ atleta.idade }} anos</div>
                </div>
                <div>
                    <div class="atleta-detalhe-label">üìè Altura</div>
                    <div class="atleta-detalhe-value">{{ atleta.altura }} m</div>
                </div>
                <div>
                    <div class="atleta-detalhe-label">‚öñÔ∏è Peso</div>
                    <div class="atleta-detalhe-value">{{ atleta.peso }} kg</div>
                </div>
                <div>
                    <div class="atleta-detalhe-label">üèÜ Clube</div>
                    <div class="atleta-detalhe-value">{{ atleta.clube }}</div>
                </div>
                <div>
                    <div class="atleta-detalhe-label">‚öΩ Posi√ß√£o</div>
                    <div class="atleta-detalhe-value">{{ atleta.posicao }}</div>
                </div>
                <div>
                    <div class="atleta-detalhe-label">üéÆ Total de Jogos</div>
                    <div class="atleta-detalhe-value">{{ atleta.numeroTotalDeJogos }}</div>
                </div>
                <div>
                    <div class="atleta-detalhe-label">‚≠ê Jogos como Titular</div>
                    <div class="atleta-detalhe-value">{{ atleta.numeroDeJogosComoTitular }}</div>
                </div>
                <div>
                    <div class="atleta-detalhe-label">üìä Taxa de Titularidade</div>
                    <div class="atleta-detalhe-value">{% widthratio atleta.numeroDeJogosComoTitular atleta.numeroTotalDeJogos 100 %}%</div>
                </div>
            </div>
        </div>
        {% endwith %}
        {% endif %}
        {% if atletas %}
        <div class="atleta-encontrados-card">
            <h2>Atletas Encontrados</h2>
            <p>Exibindo {{ atletas|length }} atleta(s)</p>
        </div>
        <div class="responsive-table">
            <table class="atleta-table">
                <thead>
                    <tr class="table-header">
                        <th class="table-cel">üë§ Nome</th>
                        <th class="table-cel">üÜî CPF</th>
                        <th class="table-cel">üèÜ Clube</th>
                        <th class="table-cel">‚öΩ Posi√ß√£o</th>
                    </tr>
                </thead>
                <tbody>
                    {% for atleta in atletas %}
                    <tr class="table-row">
                        <td class="table-cel">{{ atleta.nome }}</td>
                        <td class="table-cel">{{ atleta.cpf }}</td>
                        <td class="table-cel">{{ atleta.clube }}</td>
                        <td class="table-cel">{{ atleta.posicao }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
            <div class="atleta-header" style="margin-top: 24px;">
                <p style="color:#FFD700;">Nenhum atleta encontrado.</p>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}
